<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Anonymous">

<title>Homework 1 Answers</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="HW1 1_files/libs/clipboard/clipboard.min.js"></script>
<script src="HW1 1_files/libs/quarto-html/quarto.js"></script>
<script src="HW1 1_files/libs/quarto-html/popper.min.js"></script>
<script src="HW1 1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="HW1 1_files/libs/quarto-html/anchor.min.js"></script>
<link href="HW1 1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="HW1 1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="HW1 1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="HW1 1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="HW1 1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Homework 1 Answers</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Anonymous </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="setup" class="level1">
<h1>Setup</h1>
</section>
<section id="q1" class="level1">
<h1>Q1</h1>
<p><strong>Answer:</strong></p>
<p>id: Identifier</p>
<p>type: Categorical variables</p>
<p>boatClass: Categorical variables</p>
<p>year: Categorical variables</p>
<p>condition: Categorrical</p>
<p>length_ft: Quantitative</p>
<p>beam_ft: Quantitative</p>
<p>dryWeight_lb: Quantitative</p>
<p>price: Quantitative</p>
<p>sellerId: Identifier or categorcial</p>
</section>
<section id="q2-literature-review" class="level1">
<h1>Q2: Literature review</h1>
<p><strong>Answer:</strong></p>
<ol type="1">
<li>Condition: Used boats can be cheaper while having almost the same performance as new ones. Type: The function of the boat should match with your reason for purchasing. Price: Some boats are affordable while others are not. The price correlates with its power systems, electronics and designs. Brands: Different boat manufactorers have different insurance, discounts and after-sales policies.</li>
</ol>
<p>Links:https://www.boatsetter.com/boating-resources/things-to-know-before-buying-a-boat#:~:text=Some%20of%20the%20steps%20you%20should%20take%20when,doing%20a%20full%20inspection%2C%20and%20closing%20the%20deal. https://www.boats.com/boat-sellers-guide/boat-prices-and-boat-values/</p>
<ol start="2" type="1">
<li>Conditions and prices: Used boats can be cheaper while having almost the same performance as new ones. Types and prices: The price of the boat varies among different boat types. Bowriders are usually between $25,000 and $50,000 while cruisers range from $6,155 - $1,663,731. Within the same price, the better the performance is, the more expensive the price usually is. Length &amp; beam and prize: Usually, the larger a boat is, the more expensive it is.</li>
</ol>
<p>Links: www.imdb.com/name/nm0696975/ https://www.bing.com/ck/a?!&amp;&amp;p=ef0d97b18ac9d136JmltdHM9MTcxMTQ5NzYwMCZpZ3VpZD0zMWQ0Yzk4YS02M2I4LTY4MjktMWJhMy1kZDg4NjI5MTY5Y2YmaW5zaWQ9NTI2Nw&amp;ptn=3&amp;ver=2&amp;hsh=3&amp;fclid=31d4c98a-63b8-6829-1ba3-dd88629169cf&amp;psq=cruiser+boat+price&amp;u=a1aHR0cHM6Ly93d3cuYm9hdHMuY29tL2JvYXRzLWZvci1zYWxlLz9tYWtlPWNydWlzZXJz&amp;ntb=1</p>
</section>
<section id="q3-describing-the-data-10-points" class="level1">
<h1>Q3: Describing the data (10 points)</h1>
<p><strong>Answer</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boats,<span class="fu">aes</span>(<span class="at">x=</span>price))<span class="sc">+</span><span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HW1-1_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>1) It surprised me. Most of the price are below 500000 USD while there are a few outliers with extremely expensive price.</p>
<p>2) Median. The mean of these data is profoundly affected by outliers and thus being unable to represent the whole dataset while the median is not.</p>
<p>3) ↓</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>boats_price_summa <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">min =</span> <span class="fu">min</span>(boats<span class="sc">$</span>price), </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Q1 =</span> <span class="fu">quantile</span>(boats<span class="sc">$</span>price, <span class="fl">0.25</span>), </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">median =</span> <span class="fu">median</span>(boats<span class="sc">$</span>price), </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Q3 =</span> <span class="fu">quantile</span>(boats<span class="sc">$</span>price, <span class="fl">0.75</span>), </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">max =</span> <span class="fu">max</span>(boats<span class="sc">$</span>price))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(boats_price_summa,<span class="at">col.names=</span><span class="st">"Values"</span>,<span class="at">caption =</span> <span class="st">"&lt;b&gt;The 5 number summary of boat price&lt;/b&gt;"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption><b>The 5 number summary of boat price</b></caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">min</td>
<td style="text-align: right;">519.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q1.25%</td>
<td style="text-align: right;">19995.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">median</td>
<td style="text-align: right;">35680.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q3.75%</td>
<td style="text-align: right;">59947.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max</td>
<td style="text-align: right;">1799900.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>4) ↓</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>standard_deviation<span class="ot">&lt;-</span><span class="fu">sd</span>(boats<span class="sc">$</span>price)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>standard_deviation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 153042.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>coefficient_of_variation<span class="ot">&lt;-</span>standard_deviation<span class="sc">/</span><span class="fu">mean</span>(boats<span class="sc">$</span>price)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>coefficient_of_variation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.136164</code></pre>
</div>
</div>
<p>The standard deviation is around 2.14 times larger than the mean. There is a significant variation among the price of the boats.</p>
<p>5) It would benefit from transformation. I removed the boats which are unnecessarily expensive. Those extremely expensive prices are special cases and don’t have much reference value. Since Q3 for the price data is around 6e+4, I first set the maximum price (6e+4)/(3/4)=8e+4 but found it too low. Then, by examine the histogram for boats cheaper than 7.5e+5, I selected 1.5e+5 as the boundary for disposed values and retained values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>filtered_boats<span class="ot">&lt;-</span>boats<span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(price<span class="sc">&lt;</span><span class="dv">150000</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_boats,<span class="fu">aes</span>(<span class="at">x=</span>price))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">10000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HW1-1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>6) ↓</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_boats,<span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y=</span>price))<span class="sc">+</span><span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HW1-1_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="q4-comparing-categorical-variables" class="level1">
<h1>Q4: Comparing categorical variables</h1>
<p><strong>Answer:</strong></p>
<p>1)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fuel.type.table <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">factor</span>(boats<span class="sc">$</span>fuelType), <span class="fu">factor</span>(boats<span class="sc">$</span>year))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(fuel.type.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">1950</th>
<th style="text-align: right;">1963</th>
<th style="text-align: right;">1970</th>
<th style="text-align: right;">1971</th>
<th style="text-align: right;">1973</th>
<th style="text-align: right;">1975</th>
<th style="text-align: right;">1976</th>
<th style="text-align: right;">1977</th>
<th style="text-align: right;">1980</th>
<th style="text-align: right;">1981</th>
<th style="text-align: right;">1984</th>
<th style="text-align: right;">1985</th>
<th style="text-align: right;">1986</th>
<th style="text-align: right;">1987</th>
<th style="text-align: right;">1988</th>
<th style="text-align: right;">1989</th>
<th style="text-align: right;">1990</th>
<th style="text-align: right;">1991</th>
<th style="text-align: right;">1994</th>
<th style="text-align: right;">1995</th>
<th style="text-align: right;">1997</th>
<th style="text-align: right;">1998</th>
<th style="text-align: right;">1999</th>
<th style="text-align: right;">2000</th>
<th style="text-align: right;">2001</th>
<th style="text-align: right;">2002</th>
<th style="text-align: right;">2003</th>
<th style="text-align: right;">2004</th>
<th style="text-align: right;">2005</th>
<th style="text-align: right;">2006</th>
<th style="text-align: right;">2007</th>
<th style="text-align: right;">2008</th>
<th style="text-align: right;">2009</th>
<th style="text-align: right;">2010</th>
<th style="text-align: right;">2011</th>
<th style="text-align: right;">2012</th>
<th style="text-align: right;">2013</th>
<th style="text-align: right;">2014</th>
<th style="text-align: right;">2015</th>
<th style="text-align: right;">2016</th>
<th style="text-align: right;">2017</th>
<th style="text-align: right;">2018</th>
<th style="text-align: right;">2019</th>
<th style="text-align: right;">2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">diesel</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gasoline</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">other</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">34</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>boats_decades <span class="ot">&lt;-</span> boats <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decade =</span> <span class="dv">10</span> <span class="sc">*</span> (year <span class="sc">%/%</span> <span class="dv">10</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>boats_decades <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fuelType, decade) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(decade, n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'fuelType'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 9
# Groups:   fuelType [4]
  fuelType   `1950` `1960` `1970` `1980` `1990` `2000` `2010` `2020`
  &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;
1 ""             NA     NA     NA     NA      1      1     52     NA
2 "diesel"       NA     NA      2      2      3      9      7     NA
3 "gasoline"     NA     NA      3     11     12     20     89      2
4 "other"         1      1      2      1      9     22    103     34</code></pre>
</div>
</div>
<p>2)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">addmargins</span>(fuel.type.table))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">1950</th>
<th style="text-align: right;">1963</th>
<th style="text-align: right;">1970</th>
<th style="text-align: right;">1971</th>
<th style="text-align: right;">1973</th>
<th style="text-align: right;">1975</th>
<th style="text-align: right;">1976</th>
<th style="text-align: right;">1977</th>
<th style="text-align: right;">1980</th>
<th style="text-align: right;">1981</th>
<th style="text-align: right;">1984</th>
<th style="text-align: right;">1985</th>
<th style="text-align: right;">1986</th>
<th style="text-align: right;">1987</th>
<th style="text-align: right;">1988</th>
<th style="text-align: right;">1989</th>
<th style="text-align: right;">1990</th>
<th style="text-align: right;">1991</th>
<th style="text-align: right;">1994</th>
<th style="text-align: right;">1995</th>
<th style="text-align: right;">1997</th>
<th style="text-align: right;">1998</th>
<th style="text-align: right;">1999</th>
<th style="text-align: right;">2000</th>
<th style="text-align: right;">2001</th>
<th style="text-align: right;">2002</th>
<th style="text-align: right;">2003</th>
<th style="text-align: right;">2004</th>
<th style="text-align: right;">2005</th>
<th style="text-align: right;">2006</th>
<th style="text-align: right;">2007</th>
<th style="text-align: right;">2008</th>
<th style="text-align: right;">2009</th>
<th style="text-align: right;">2010</th>
<th style="text-align: right;">2011</th>
<th style="text-align: right;">2012</th>
<th style="text-align: right;">2013</th>
<th style="text-align: right;">2014</th>
<th style="text-align: right;">2015</th>
<th style="text-align: right;">2016</th>
<th style="text-align: right;">2017</th>
<th style="text-align: right;">2018</th>
<th style="text-align: right;">2019</th>
<th style="text-align: right;">2020</th>
<th style="text-align: right;">Sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="even">
<td style="text-align: left;">diesel</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gasoline</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">137</td>
</tr>
<tr class="even">
<td style="text-align: left;">other</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">173</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sum</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">161</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">387</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>3)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(fuel.type.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          
                  1950        1963        1970        1971        1973
           0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
  diesel   0.000000000 0.000000000 0.002583979 0.002583979 0.000000000
  gasoline 0.000000000 0.000000000 0.000000000 0.000000000 0.002583979
  other    0.002583979 0.002583979 0.000000000 0.000000000 0.000000000
          
                  1975        1976        1977        1980        1981
           0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
  diesel   0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
  gasoline 0.002583979 0.000000000 0.002583979 0.002583979 0.002583979
  other    0.000000000 0.002583979 0.002583979 0.000000000 0.000000000
          
                  1984        1985        1986        1987        1988
           0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
  diesel   0.000000000 0.002583979 0.000000000 0.000000000 0.002583979
  gasoline 0.005167959 0.000000000 0.002583979 0.002583979 0.002583979
  other    0.002583979 0.000000000 0.000000000 0.000000000 0.000000000
          
                  1989        1990        1991        1994        1995
           0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
  diesel   0.000000000 0.000000000 0.000000000 0.002583979 0.000000000
  gasoline 0.010335917 0.002583979 0.007751938 0.002583979 0.005167959
  other    0.000000000 0.000000000 0.002583979 0.007751938 0.000000000
          
                  1997        1998        1999        2000        2001
           0.000000000 0.000000000 0.002583979 0.000000000 0.000000000
  diesel   0.000000000 0.002583979 0.002583979 0.002583979 0.000000000
  gasoline 0.000000000 0.005167959 0.007751938 0.010335917 0.005167959
  other    0.002583979 0.007751938 0.002583979 0.007751938 0.000000000
          
                  2002        2003        2004        2005        2006
           0.000000000 0.000000000 0.000000000 0.000000000 0.002583979
  diesel   0.000000000 0.005167959 0.000000000 0.005167959 0.002583979
  gasoline 0.005167959 0.005167959 0.007751938 0.000000000 0.007751938
  other    0.000000000 0.010335917 0.005167959 0.005167959 0.000000000
          
                  2007        2008        2009        2010        2011
           0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
  diesel   0.005167959 0.000000000 0.002583979 0.000000000 0.000000000
  gasoline 0.000000000 0.002583979 0.007751938 0.007751938 0.002583979
  other    0.012919897 0.012919897 0.002583979 0.005167959 0.007751938
          
                  2012        2013        2014        2015        2016
           0.000000000 0.000000000 0.000000000 0.000000000 0.005167959
  diesel   0.002583979 0.000000000 0.002583979 0.002583979 0.005167959
  gasoline 0.005167959 0.007751938 0.005167959 0.005167959 0.005167959
  other    0.002583979 0.002583979 0.018087855 0.010335917 0.007751938
          
                  2017        2018        2019        2020
           0.005167959 0.015503876 0.108527132 0.000000000
  diesel   0.002583979 0.000000000 0.002583979 0.000000000
  gasoline 0.018087855 0.033591731 0.139534884 0.005167959
  other    0.015503876 0.031007752 0.165374677 0.087855297</code></pre>
</div>
</div>
<p>4) I would recommend the gasoline boats and boats using other tyoes of fuels. As we can see from the histogram below, among the boats with known fuel type, gasoline boats and boats using other fuel types are rapidly increasing in proportions, suggesting that they are probably increasingly favorable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>boat_fuel<span class="ot">&lt;-</span> boats <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fuelType)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boat_fuel,<span class="fu">aes</span>(<span class="at">x=</span>year,<span class="at">fill=</span>fuelType))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..),<span class="at">position=</span><span class="st">"dodge"</span>,<span class="at">binwidth =</span> <span class="dv">10</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boat Fuel Type Proportions"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>,<span class="at">fill=</span><span class="st">"Fuel types"</span>)<span class="sc">+</span><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gasoline"</span> <span class="ot">=</span> <span class="st">"skyblue"</span>, <span class="st">"diesel"</span> <span class="ot">=</span> <span class="st">"lightgreen"</span>, <span class="st">"other"</span> <span class="ot">=</span> <span class="st">"pink"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(density)` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HW1-1_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="q5-understanding-and-comparing-distributions" class="level1">
<h1>Q5: Understanding and comparing distributions</h1>
<p><strong>Answer:</strong> 1)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>boats_len_summa <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">min =</span> <span class="fu">min</span>(boats<span class="sc">$</span>length_ft), </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Q1 =</span> <span class="fu">quantile</span>(boats<span class="sc">$</span>length_ft, <span class="fl">0.25</span>), </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">median =</span> <span class="fu">median</span>(boats<span class="sc">$</span>length_ft), </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Q3 =</span> <span class="fu">quantile</span>(boats<span class="sc">$</span>length_ft, <span class="fl">0.75</span>), </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">max =</span> <span class="fu">max</span>(boats<span class="sc">$</span>length_ft))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(boats_len_summa,<span class="at">col.names=</span><span class="st">"Length (feet)"</span>,<span class="at">caption =</span> <span class="st">"&lt;b&gt;The 5 number summary of boat length&lt;/b&gt;"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption><b>The 5 number summary of boat length</b></caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Length (feet)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">min</td>
<td style="text-align: right;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q1.25%</td>
<td style="text-align: right;">18.58</td>
</tr>
<tr class="odd">
<td style="text-align: left;">median</td>
<td style="text-align: right;">21.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q3.75%</td>
<td style="text-align: right;">25.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max</td>
<td style="text-align: right;">120.00</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>upper.fence<span class="ot">&lt;-</span><span class="dv">25</span><span class="fl">+1.5</span><span class="sc">*</span>(<span class="dv">25</span><span class="fl">-18.58</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>upper.fence</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 34.63</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>lower.fence<span class="ot">&lt;-</span> <span class="fl">18.58-1.5</span><span class="sc">*</span>(<span class="dv">25</span><span class="fl">-18.58</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>lower.fence</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.95</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>upper.filtered.boats <span class="ot">&lt;-</span> boats<span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(length_ft<span class="sc">&gt;</span>upper.fence)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>upper.filtered.boats <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fuelType) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(fuelType, n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  diesel gasoline other
   &lt;int&gt;    &lt;int&gt; &lt;int&gt;
1     20       17     5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>lower.filtered.boats <span class="ot">&lt;-</span> boats<span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(length_ft<span class="sc">&lt;</span>lower.fence)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>lower.filtered.boats <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fuelType) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(fuelType, n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  gasoline other
     &lt;int&gt; &lt;int&gt;
1        2     8</code></pre>
</div>
</div>
<p>According to the tables, there are 42 outliers with sizes larger than usual and 10 outliers with sizes smaller than usual. They are not outliers caused by wrongful measurements or chance, thus cannot be neglected.</p>
<p>2)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boats,<span class="fu">aes</span>(<span class="at">x=</span>fuelType, <span class="at">y=</span>length_ft))<span class="sc">+</span><span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HW1-1_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see from the tables that diesel boats are generally larger in size.</p>
</section>
<section id="q6-the-normal-distribution" class="level1">
<h1>Q6: The Normal distribution</h1>
<p>For boats under 20 feet, a rough rule of thumb is that the maximum weight capacity in kilograms of a boat is approximately the length in feet times the width (or beam) of the boat times 5. In a 2006 study of Americans, the average weight was approximately 70 kilos with a standard deviation of 11 kilos.</p>
<p><strong>Answer:</strong> 1) sd=21.27kg, mean=73.16kg,</p>
<p>f(x)=e^{[-(x-73.16)^2]/109981}/88.78</p>
<p>Data comes from adults in the CDC’s 2015-16 NHANES survey. Weights were measured at a mobile examination center (MEC).</p>
<p>2)</p>
<table class="table">
<caption>Boats under 20ft</caption>
<thead>
<tr class="header">
<th>ID</th>
<th>Length (ft)</th>
<th>Beam (ft)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6842735</td>
<td>9.83</td>
<td>4.33</td>
</tr>
<tr class="even">
<td>7055543</td>
<td>9.83</td>
<td>4.33</td>
</tr>
<tr class="odd">
<td>6219877</td>
<td>3</td>
<td>1</td>
</tr>
<tr class="even">
<td>7041942</td>
<td>18.67</td>
<td>7.83</td>
</tr>
<tr class="odd">
<td>6796269</td>
<td>18.67</td>
<td>7.83</td>
</tr>
</tbody>
</table>
<p>3)</p>
<table class="table">
<caption>Boats under 20ft</caption>
<thead>
<tr class="header">
<th></th>
<th>-0.295</th>
<th>-1.32</th>
<th>1.03</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ID</td>
<td>6219877</td>
<td>6842735</td>
<td>7041942</td>
</tr>
<tr class="even">
<td>ID</td>
<td></td>
<td>7055543</td>
<td>6796269</td>
</tr>
</tbody>
</table>
<p>4) The passengers each weigh: 73.16-2*21.27=30.62, 73.16-21.27=51.89, 73.16, 7316+21.27=94.43, 73.16+2*21.27=115.7 (kg)</p>
<p>Maximum weight capacity: Length*beam*5</p>
<p>Thus, for the boats with Z scores -0.295, -1.32, 1.03，the weight capacity is: 212.82kg, 15kg, 730.93kg.</p>
<table class="table">
<caption>Boats and passengers capacity</caption>
<thead>
<tr class="header">
<th></th>
<th>-2</th>
<th>-1</th>
<th>0</th>
<th>1</th>
<th>2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6219877</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>6842735/7055543</td>
<td>7</td>
<td>4</td>
<td>3</td>
<td>2</td>
<td>2</td>
</tr>
<tr class="odd">
<td>7041942/6796269</td>
<td>23</td>
<td>13</td>
<td>9</td>
<td>7</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>Were I a boat maker, the cutoff capacity should be calculated using people with weight Z score +1. +2 is uneccesary because it’s very rare and the cost of seat would be high. 0 is not as good as +1 because it’s merely 50% possibility that the total weight of full-loaded passengers will surpass the weight capacity.</p>
<p>5)</p>
<p>6219877: Two passengers, Z: &lt;-2</p>
<p>6842735/7055543: Two passengers, Z: +1</p>
<p>7041942/6796269: Two passengers, Z: &gt;+2</p>
<p>6219877 is a powered inflatable boat, while 7041942/6796269 are wooden boats. The materials might influenced their passenger capacities.</p>
<p>Data from <a href="https://www.boats.com/">Boats.com</a></p>
</section>
<section id="q7" class="level1">
<h1>Q7</h1>
<p><strong>Answer:</strong></p>
<p>1)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boats, <span class="fu">aes</span>(<span class="at">x=</span>length_ft, <span class="at">y=</span>price))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="st">"blue"</span>)<span class="sc">+</span><span class="fu">geom_text</span>(<span class="at">data=</span>boats <span class="sc">%&gt;%</span> <span class="fu">filter</span>(length_ft <span class="sc">&gt;</span> <span class="dv">50</span>),<span class="fu">aes</span>(<span class="at">label=</span>id), <span class="at">vjust=</span><span class="fl">0.5</span>, <span class="at">color=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HW1-1_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There’s no clear pattern. Generally, the larger the length is, the more expensive the price is. Hoever, price is an essential factor influencing the price. The outliers shouldn’t be excluded directly. They are not generated by false measurements or by chance. We can decide to exclude or include them according to the requirements of our statistic analysis.</p>
<p>2)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>boat.filter<span class="ot">&lt;-</span>boats<span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(price<span class="sc">&lt;</span><span class="dv">100000</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boat.filter, <span class="fu">aes</span>(<span class="at">x=</span>length_ft, <span class="at">y=</span>price))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HW1-1_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The correlation can be 0.75, it is quite strong. We can communicate with the client about the profit for making and selling the boats.</p>
<p>3)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>boat.filter<span class="ot">&lt;-</span>boats<span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(price<span class="sc">&lt;</span><span class="dv">100000</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boat.filter, <span class="fu">aes</span>(<span class="at">x=</span>length_ft, <span class="at">y=</span>price, <span class="at">color=</span>condition))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">se=</span><span class="cn">FALSE</span>,<span class="at">color=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HW1-1_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Yes. Used boats distibute widely in size and are much cheaper than new ones.</p>
</section>
<section id="q8-putting-it-all-together" class="level1">
<h1>Q8: Putting it all together</h1>
<p><strong>Answer:</strong></p>
<p>1) The first line chart depicted the relationship between general boat size (boat length times boat beam) and boat price. Generally, the larger the size of the boat is, the more expensive the boat is. Of course, it’s apparent to see that boat size does not decides on boat price.</p>
<p>The second box chart compared the price of boats per square meter of general boat size with different fuel types. Generally, diesel boats are generally more expensive than boats using other types of fuels while gasoline boats have more expensive outliers in price. It’s estimated that gasoline boats have diverse usages.</p>
<p>The third histogram shows that new boats are getting increasingly popular recently. Customers seem to care more about the sailing experience and the emotional value of buying a ship than just the price than before.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boats,<span class="fu">aes</span>(<span class="at">x=</span>length_ft<span class="sc">*</span>beam_ft,<span class="at">y=</span>price))<span class="sc">+</span><span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 140 rows containing missing values (`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HW1-1_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>boat.filter<span class="ot">&lt;-</span>boats<span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(price<span class="sc">/</span>(length_ft<span class="sc">*</span>beam_ft)<span class="sc">&lt;</span><span class="dv">10000</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boat.filter,<span class="fu">aes</span>(<span class="at">x=</span>fuelType, <span class="at">y=</span>price<span class="sc">/</span>(length_ft<span class="sc">*</span>beam_ft)))<span class="sc">+</span><span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HW1-1_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>boats.condition<span class="ot">&lt;-</span> boats <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boats.condition,<span class="fu">aes</span>(<span class="at">x=</span>year,<span class="at">fill=</span>condition))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..),<span class="at">position=</span><span class="st">"dodge"</span>,<span class="at">binwidth =</span> <span class="dv">10</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boat Fuel Type Proportions"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>,<span class="at">fill=</span><span class="st">"Condition"</span>)<span class="sc">+</span><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"new"</span> <span class="ot">=</span> <span class="st">"skyblue"</span>, <span class="st">"used"</span> <span class="ot">=</span> <span class="st">"lightgreen"</span>, <span class="st">"other"</span> <span class="ot">=</span> <span class="st">"pink"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="HW1-1_files/figure-html/unnamed-chunk-18-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>2) Finding 1: Most of the boats gather at price range of 100,000 USD, while there are outliers with extremely high price. It’s recommended for clients to fist select a price range according to the requirment on boat type and then look through a detail.</p>
<p>Finding 2: Diesel engines are commonly used in large and expensive boats while gasoline boats have diverse sizes and prices. Also, gasoline boats are getting increasing popular in recent years. Unless there is a special need, the client is recommended to purchase gasoline boats.</p>
<p>Finding 3: If the client is looking for cheap boats, he or she may prioritise second-hand ones. They are cheaper in price and its easy to obtain user experience and experiments on using and mantianience from the previous owner.</p>
<p>3) First, gasoline boats can earn more money than diesel ones unless our business is targeted at realm where diesel boats are favoured. Second, we can offer a second-hand boat trading services while stick to manufacturing new boats since new ones are more popular than before. Third, we can try to get some special large orders, these orders of boats may be unusually expensive, and at the same time make more money than ordinary orders.</p>
<p>4) Q1-Q7 failt to recognize the influence of size of the boats on the boat price. For instance, when comparing prices of different fuel types, we fail to be aware that diesel are usually used in larger boats which are more expensive. Thus, the price difference between diesel and gasoline boats are overplayed.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>